import { createContext, useContext, useState, useEffect, type ReactNode } from "react";

export type Language = "ru" | "en";

interface I18nContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
}

const translations: Record<Language, Record<string, string>> = {
  en: {
    // Navigation
    "nav.dashboard": "Dashboard",
    "nav.sources": "Sources",
    "nav.topics": "Topics",
    "nav.scripts": "Scripts",
    "nav.settings": "Settings",
    "nav.assistant": "Assistant",
    "nav.info": "Information",
    "nav.stockSearch": "Stock Search",

    // Stock Search
    "stock.title": "STOCK SEARCH",
    "stock.subtitle": "Search free videos, photos, and audio from Pexels, Pixabay, Unsplash, Freesound",
    "stock.videos": "Videos",
    "stock.photos": "Photos",
    "stock.audio": "Audio",
    "stock.search": "Search",
    "stock.searchPlaceholder": "Enter search query (auto-translated to English)",
    "stock.translatedTo": "Translated to",
    "stock.noResults": "No results found",
    "stock.tryDifferent": "Try a different search query",
    "stock.configureApi": "Configure API keys in settings for more results",
    "stock.portrait": "Vertical",
    "stock.landscape": "Horizontal",
    "stock.loadMore": "Load More",
    "stock.loading": "Loading...",
    "stock.download": "Download",
    
    // Dashboard
    "dashboard.title": "Dashboard",
    "dashboard.subtitle": "Create and generate videos, track latest trends and news, view your scripts in progress. Use the menu to access other sections.",
    "dashboard.updateTopics": "Update Topics",
    "dashboard.fetchingTopics": "Fetching topics",
    "dashboard.fetchingDescription": "Started fetching topics from all sources",
    "dashboard.totalTopics": "Total Topics",
    "dashboard.scriptsInWork": "Scripts in Work",
    "dashboard.scriptsInWorkShort": "In Work",
    "dashboard.readyScripts": "Ready Scripts",
    "dashboard.readyScriptsShort": "Ready",
    "dashboard.createFromText": "VIDEO FROM TEXT",
    "dashboard.createFromTextShort": "FROM TEXT",
    "dashboard.createFromMaterial": "VIDEO FROM MATERIAL",
    "dashboard.createFromMaterialShort": "FROM MATERIAL",
    "dashboard.createFromTextDesc": "Script and storyboard generation from your idea or news link, full video prep package",
    "dashboard.createFromMaterialDesc": "Upload your footage",
    "dashboard.tip": "To create a flow of Shorts and vertical content: add sources and generate short videos from them!",
    "dashboard.activeJobs": "Active Jobs",
    "dashboard.recentTopics": "Topics: Source Material",
    "dashboard.recentTopicsShort": "Topics",
    "dashboard.recentScripts": "Recent Scripts",
    "dashboard.recentScriptsShort": "Scripts",
    "dashboard.noActiveJobs": "No active jobs",
    "dashboard.allJobsCompleted": "All background tasks completed",
    "dashboard.viewAll": "View All",
    
    // Text to Video
    "ttv.title": "VIDEO FROM TEXT",
    "ttv.inputLabel": "Source Text",
    "ttv.inputPlaceholder": "Enter your text, idea, or script draft here. The more details you provide, the better the result...",
    "ttv.characters": "characters",
    "ttv.minCharacters": "Minimum 50 characters",
    "ttv.settings": "Generation Settings",
    "ttv.language": "Generation Language",
    "ttv.style": "Script Style",
    "ttv.duration": "Duration",
    "ttv.seconds": "sec",
    "ttv.minutes": "min",
    "ttv.sec": "sec",
    "ttv.min": "min",
    "ttv.generate": "Generate",
    "ttv.generating": "Generating...",
    "ttv.generatingHint": "AI is analyzing your text and creating content...",
    "ttv.generationComplete": "Generation Complete",
    "ttv.generationCompleteDesc": "Script, storyboard and SEO data generated successfully",
    "ttv.generationError": "Generation failed",
    "ttv.textRequired": "Text Required",
    "ttv.textRequiredDesc": "Please enter your text or idea",
    "ttv.textTooShort": "Text Too Short",
    "ttv.textTooShortDesc": "Please enter at least 50 characters",
    "ttv.analysisNotes": "AI Analysis Notes",
    "ttv.seoTitle": "SEO Title",
    "ttv.hashtags": "Hashtags",
    "ttv.fullScript": "Full Script",
    "ttv.voiceover": "Voiceover with Timecodes",
    "ttv.timecode": "Timecode",
    "ttv.voiceText": "Text",
    "ttv.storyboard": "Storyboard",
    "ttv.time": "Time",
    "ttv.visual": "Visual",
    "ttv.onScreenText": "On-Screen",
    "ttv.sfx": "SFX",
    "ttv.hint": "Enter any text: article, idea, news summary, or rough draft. AI will analyze it and generate a complete video script with SEO title, hashtags, voiceover timecodes, and storyboard.",
    "ttv.voiceoverSaved": "Voiceover Saved",
    "ttv.voiceoverSavedDesc": "Changes saved to the script",
    "ttv.voiceoverUpdated": "Voiceover Updated",
    "ttv.storyboardSaved": "Storyboard Saved",
    "ttv.storyboardSavedDesc": "Changes saved to the script",
    "ttv.storyboardUpdated": "Storyboard Updated",
    "ttv.savedToScripts": "Saved to Recent Scripts",
    "ttv.viewScript": "View Script",
    "ttv.apiKeyRequired": "API Key Required",
    "ttv.apiKeyRequiredDesc": "Set OpenRouter API key (free) in Settings to generate scripts.",
    
    // Sources
    "sources.title": "Sources",
    "sources.subtitle": "Manage your content sources",
    "sources.addSource": "Add Source",
    "sources.noSources": "No sources yet",
    "sources.addFirstSource": "Add your first content source to start discovering topics",
    "sources.name": "Name",
    "sources.type": "Type",
    "sources.url": "URL",
    "sources.enabled": "Enabled",
    "sources.disabled": "Disabled",
    "sources.rss": "RSS Feed",
    "sources.telegram": "Telegram",
    "sources.manual": "Manual",
    "sources.urlSource": "URL",
    "sources.delete": "Delete",
    "sources.save": "Save",
    "sources.cancel": "Cancel",
    "sources.editSource": "Edit Source",
    "sources.addNewSource": "Add New Source",
    "sources.dialogDesc": "Configure a new content source for topic discovery",
    "sources.namePlaceholder": "My Source",
    "sources.telegramHint": "Use RSSHub format for Telegram channels",
    "sources.description": "Description",
    "sources.descriptionPlaceholder": "Describe what topics this source covers...",
    "sources.created": "Source created",
    "sources.createdDesc": "Your new source has been added",
    "sources.createError": "Failed to create source",
    "sources.updated": "Source updated",
    "sources.updatedDesc": "Your source has been updated",
    "sources.updateError": "Failed to update source",
    "sources.deleted": "Source deleted",
    "sources.deletedDesc": "The source has been removed",
    "sources.deleteError": "Failed to delete source",
    
    // Topics
    "topics.title": "Topics",
    "topics.subtitle": "Discover and select trending topics for content creation",
    "topics.refresh": "Refresh Topics",
    "topics.noTopics": "No topics yet",
    "topics.clickRefresh": "Click 'Refresh Topics' to fetch content from your sources",
    "topics.all": "All",
    "topics.new": "New",
    "topics.inProgress": "In Progress",
    "topics.missed": "Missed",
    "topics.sortByScore": "By Score",
    "topics.sortByDate": "By Date",
    "topics.select": "Select",
    "topics.ignore": "Ignore",
    "topics.score": "Score",
    "topics.source": "Source",
    "topics.fetchError": "Failed to start fetch",
    "topics.scriptCreated": "Script created",
    "topics.scriptCreatedDesc": "You selected a topic and created a script, now you can start generating!",
    "topics.selectError": "Failed to create script",
    "topics.noFilteredTopics": "No topics found",
    "topics.noFilteredDesc": "No topics with this status",
    "topics.topicMissed": "Topic missed",
    "topics.topicMissedDesc": "Topic has been marked as missed",
    "topics.cleared": "Topics cleared",
    "topics.clearedDesc": "All topics have been deleted",
    "topics.clearConfirm": "Delete all topics?",
    "topics.clearError": "Failed to clear topics",
    "dashboard.fetchError": "Failed to start topic fetch",
    
    // Scripts
    "scripts.title": "Scripts",
    "scripts.subtitle": "Manage your generated scripts",
    "scripts.noScripts": "No scripts yet",
    "scripts.selectTopic": "Select a topic to create your first script",
    "scripts.goToTopics": "Go to Topics",
    "scripts.status.draft": "Draft",
    "scripts.status.generating": "Generating",
    "scripts.status.ready": "Ready",
    "scripts.status.approved": "Approved",
    "scripts.status.exported": "Exported",
    "scripts.status.error": "Error",
    "scripts.untitled": "Untitled Script",
    "scripts.updated": "Updated",
    "scripts.noFilteredScripts": "No scripts found",
    "scripts.noFilteredDesc": "No scripts with this status",
    
    // Script Detail
    "script.title": "Script",
    "script.back": "Back",
    "script.generateAll": "Generate All",
    "script.export": "Export",
    "script.overview": "Overview",
    "script.content": "Content",
    "script.storyboard": "Timeline",
    "script.audio": "Audio",
    "script.topic": "Topic",
    "script.style": "Style",
    "script.duration": "Duration",
    "script.format": "Format",
    "script.formatShorts": "Shorts",
    "script.formatHorizontal": "Horizontal Video",
    "script.language": "Language",
    "aiPrompt": "AI Prompt",
    "aiPromptCopied": "AI prompt copied to clipboard",
    "copyPrompt": "Copy",
    "script.hook": "Hook",
    "script.voiceScript": "Voice Script",
    "script.voiceScriptShort": "Text",
    "script.clickToEdit": "Click to add or edit...",
    "script.onScreenText": "On-Screen Text",
    "script.generateHook": "Generate Hook",
    "script.generateScript": "Generate Script",
    "script.generateStoryboard": "Generate Storyboard",
    "script.generateVoice": "Generate Voice",
    "script.pickMusic": "Pick Music",
    "script.scene": "Scene",
    "script.visual": "Visual",
    "script.text": "Text",
    "script.sfx": "SFX",
    "script.stockKeywords": "Stock Keywords",
    "script.music": "Music",
    "script.mood": "Mood",
    "script.bpm": "BPM",
    "script.genre": "Genre",
    "script.references": "References",
    "script.license": "License Note",
    "script.freeTrackSuggestions": "Free Track Suggestions",
    "script.edit": "Edit",
    "script.save": "Save",
    "script.cancel": "Cancel",
    "script.seconds": "seconds",
    "script.notFound": "Script not found",
    "script.notFoundDesc": "This script may have been deleted or doesn't exist.",
    "script.backToScripts": "Back to Scripts",
    "script.productionPipeline": "Production Pipeline",
    "script.exportPackage": "Export Package",
    "script.downloadAssets": "Download all assets as a ZIP file for video production",
    "script.exportZip": "Export ZIP Package",
    "script.downloadLast": "Download Last Export",
    "script.recentJobs": "Recent Jobs",
    
    // Settings
    "settings.title": "Settings",
    "settings.subtitle": "Configure API keys and default preferences",
    "settings.apiConfig": "API Configuration",
    "settings.apiConfigDesc": "Connect to OpenRouter for AI-powered content generation",
    "settings.apiKey": "OpenRouter API Key",
    "settings.model": "Default Model",
    "settings.testConnection": "Test Connection",
    "settings.testing": "Testing...",
    "settings.connected": "Connected",
    "settings.failed": "Failed",
    "settings.defaults": "Default Settings",
    "settings.defaultsDesc": "Set default values for new scripts",
    "settings.defaultDuration": "Default Duration",
    "settings.defaultStyle": "Default Style",
    "settings.fallbackMode": "Fallback Mode",
    "settings.fallbackModeDesc": "Use template-based generation when API is unavailable",
    "settings.save": "Save Settings",
    "settings.saved": "Settings saved",
    "settings.savedDesc": "Your preferences have been updated",
    "settings.saveError": "Failed to save settings",
    "settings.language": "Interface Language",
    "settings.languageDesc": "Choose your preferred language",
    "settings.theme": "Theme",
    "settings.getApiKey": "Get your API key from",
    "settings.connectedDesc": "API is working correctly",
    "settings.failedDesc": "Could not connect to the API",
    "settings.fallbackWarningTitle": "Running in Fallback Mode",
    "settings.fallbackWarningDesc": "Content will be generated using templates instead of AI. Add an API key for better results.",
    "settings.providerSelection": "AI Provider",
    "settings.providerSelectionDesc": "Choose your preferred AI provider. Groq and Together AI offer free tiers.",
    "settings.freeTier": "Free",
    "settings.aiActiveTitle": "AI Generation Active",
    "settings.aiActiveDesc": "Your scripts will be generated using AI for higher quality content.",
    
    // Common
    "common.loading": "Loading...",
    "common.error": "Error",
    "common.success": "Success",
    "common.delete": "Delete",
    "common.save": "Save",
    "common.cancel": "Cancel",
    "common.close": "Close",
    "common.add": "Add",
    "common.edit": "Edit",
    "common.view": "View",
    "common.russian": "Russian",
    "common.english": "English",
    "common.open": "Open",
    "common.generate": "Generate",
    "common.showMore": "Show more",
    "common.showLess": "Show less",
    
    // Style presets
    "style.cinematic": "Cinematic",
    "style.director": "Director",
    "style.meme": "Meme",
    "style.trend": "Trend",
    "style.classic": "Classic",
    "style.news": "News",
    
    // TTS
    "tts.title": "Voice Preview",
    "tts.description": "Preview the script with browser text-to-speech",
    "tts.voice": "Voice",
    "tts.selectVoice": "Select voice",
    "tts.speed": "Speed",
    "tts.pitch": "Pitch",
    "tts.preview": "Preview",
    "tts.stop": "Stop",
    "tts.copyText": "Copy Text",
    "tts.copied": "Copied",
    "tts.copiedDesc": "Text copied to clipboard for use with external TTS services",
    "tts.copyError": "Could not copy text to clipboard",
    "tts.playing": "Playing...",
    "tts.noText": "No text",
    "tts.noTextDesc": "Add voice script text before generating audio",
    "tts.playbackError": "Playback failed",
    "tts.notSupported": "Voice synthesis is not supported in this browser",
    "tts.hint": "Preview uses browser TTS. For production audio, copy the text and use a professional TTS service like ElevenLabs, Amazon Polly, or Google Cloud TTS.",

    // Job kinds
    "job.fetch_topics": "Fetch topics",
    "job.generate_hook": "Generate hook",
    "job.generate_script": "Generate script",
    "job.generate_storyboard": "Generate storyboard",
    "job.generate_voice": "Generate voice",
    "job.pick_music": "Pick music",
    "job.export_package": "Export package",
    "job.generate_all": "Generate all",
    
    // Script detail page (additional)
    "script.settings": "Settings",
    "script.scriptStyle": "Script Style",
    "script.voiceStyle": "Voice Style",
    "script.generateAllButton": "Generate All",
    "script.generateAllShort": "AI Gen",
    "script.pickMusicButton": "Pick Music",
    "script.noStoryboard": "No storyboard yet. Click Generate to create one.",
    "script.noMusic": "No music yet. Click Pick Music to get recommendations.",
    "script.noHook": "Click to add or generate hook...",
    "script.noVoice": "Click to add or generate voice script...",
    "script.exportDesc": "Download all assets as a ZIP file for video production",
    "script.exportZipButton": "Export ZIP Package",
    "script.tableVisual": "Visual",
    "script.tableCamera": "Camera",
    "script.tableStockKeywords": "Stock Keywords",
    "script.tableStocks": "Stock",
    "script.tableOnScreenText": "On-Screen Text",
    "script.tableSubtitles": "Subtitles",
    "script.tableDuration": "Duration",
    "script.tableTimecode": "Time",
    "script.tablePreview": "Preview",
    "script.stockKeywordsHint": "Stock keywords",
    "script.copyKeywords": "Copy keywords",
    "script.keywordsCopied": "Keywords copied to clipboard",
    "script.topicLabel": "Topic",
    "script.generationStarted": "Generation started",
    "script.exportReady": "Export ready",
    "script.exportReadyDesc": "Your package is ready for download",
    "script.scriptUpdated": "Script updated",
    "script.failedToUpdate": "Failed to update script",
    "script.failedToGenerate": "Failed to start generation",
    "script.failedToExport": "Failed to export package",
    "copied": "Copied",
    "open": "Open",
    "30seconds": "30 seconds",
    "45seconds": "45 seconds",
    "60seconds": "60 seconds",
    "120seconds": "2 minutes",
    
    // Accent
    "script.accent": "Accent",
    "accent.classic": "Classic",
    "accent.news": "News Official",
    "accent.military": "Military",
    "accent.blogger": "Blogger",
    "accent.meme": "Meme",
    "accent.dramatic": "Dramatic",
    "accent.ironic": "Ironic",
    "accent.streamer": "Streamer",
    
    // Subtitle export
    "script.subtitles": "Subtitles",
    "script.downloadSrt": "Download SRT",
    "script.downloadVtt": "Download VTT",
    "script.noSubtitles": "Generate timeline first to export subtitles",

    // Voice Generator
    "voice.title": "Voice Generator",
    "voice.description": "Choose voice style and copy text to a professional TTS service",
    "voice.styleTab": "Style",
    "voice.phrasesTab": "Phrases",
    "voice.servicesTab": "Services",
    "voice.generateFirst": "Generate voice script first",
    "voice.selected": "Selected",
    "voice.recommendedVoices": "Recommended voices:",
    "voice.copyAll": "Copy All",
    "voice.fullText": "Full Text",
    "voice.numbered": "Numbered",
    "voice.phraseCount": "{count} phrases / {chars} characters",
    "voice.serviceHint": "Click a service - text will be copied automatically, then paste it in the opened window.",
    "voice.copiedForService": "Full text copied for pasting into TTS service",
    "voice.pasteInService": "Paste the text in the opened service",
    "voice.numberedCopied": "Numbered text copied",
    "voice.tip": "Tip:",
    "voice.tipContent": "For \"{style}\" style, we recommend: {voices}",
    "voice.style.narrator": "Narrator",
    "voice.style.narrator.desc": "Professional, clear, authoritative voice for documentaries and explainers",
    "voice.style.energetic": "Energetic",
    "voice.style.energetic.desc": "High-energy, exciting voice for trends and viral content",
    "voice.style.calm": "Calm",
    "voice.style.calm.desc": "Relaxed, soothing voice for educational and lifestyle content",
    "voice.style.meme": "Meme / Fun",
    "voice.style.meme.desc": "Playful, exaggerated voice for memes and comedy content",
    "voice.style.news": "News Anchor",
    "voice.style.news.desc": "Serious, trustworthy voice for news and factual content",
    "voice.service.elevenlabs": "Best quality, 10K chars/mo free",
    "voice.service.ttsmp3": "Free unlimited, simple, instant download",
    "voice.service.freetts": "Free online TTS with download",
    "voice.service.murf": "Professional quality voices",
    "voice.service.speechify": "Natural voices, good free tier",
    "voice.downloadTab": "Download",
    "voice.downloadHint": "Use these services to generate and download audio. Text will be copied automatically.",
    "voice.generateTab": "Generate",
    "voice.generateHint": "Generate MP3 directly using free Microsoft Edge voices (no API key needed)",
    "voice.selectEdgeVoice": "Select voice",
    "voice.generateMp3": "Generate MP3",
    "voice.generating": "Generating...",
    "voice.downloadMp3": "Download MP3",
    "voice.generationError": "Failed to generate audio",
    "voice.loadingVoices": "Loading voices...",
    "voice.noVoices": "No voices available",
    "voice.rate": "Speed",
    "voice.pitch": "Pitch",
    "voice.voiceQuality": "Free high-quality neural voices",
    
    // Categories
    "category.title": "Quick Add by Category",
    "category.description": "Select a category to add multiple news sources at once",
    "category.sources": "sources",
    "category.addAll": "Add All Sources",
    "category.adding": "Adding...",
    "category.added": "Added",
    "category.exists": "Added",
    "category.sourcesAdded": "Sources added",
    "category.sourcesAddedDesc": "Added {count} sources from {category}",
    "category.alreadyExists": "Already added",
    "category.alreadyExistsDesc": "All sources from this category are already in your list",
    "category.world_news": "World News",
    "category.gaming": "Gaming",
    "category.memes": "Memes",
    "category.trends": "Trends",
    "category.fashion": "Fashion",
    "category.music": "Music",
    "category.interesting": "Interesting",
    "category.facts_research": "Facts & Research",
    "category.movies": "Movies",
    "category.series": "TV Series",
    "category.russia_news": "Russia News",
    "category.medicine": "Medicine",
    "category.youtube_trends": "YouTube Trends",
    "category.pets": "Pets & Animals",
    
    // Profile & Auth
    "profile.title": "Profile",
    "profile.nickname": "Nickname",
    "profile.nicknamePlaceholder": "Enter your nickname",
    "profile.noNickname": "No nickname set",
    "profile.subscription": "Subscription",
    "profile.activeUntil": "Active until",
    "profile.daysLeft": "days left",
    "profile.expired": "Subscription expired",
    "profile.resetSettings": "Reset Settings",
    "profile.logout": "Log Out",
    "profile.updated": "Profile updated",
    "profile.updatedDesc": "Your profile has been updated",
    "profile.updateError": "Failed to update profile",
    "profile.sessionExpired": "Session expired",
    "profile.pleaseLogin": "Please log in again",
    "profile.reset": "Settings reset",
    "profile.resetDesc": "Your settings have been reset to defaults",
    "profile.resetError": "Failed to reset settings",
    "profile.numberCopied": "Number copied",
    "auth.login": "Log In",
    "auth.welcomeBack": "Welcome back!",
    "auth.loginSuccess": "You have successfully logged in",
    "auth.invalidPassword": "Invalid password",
    "auth.passwordPlaceholder": "Enter password",
    "auth.contactAdmin": "Contact administrator for access",
  },
  ru: {
    // Navigation
    "nav.dashboard": "Панель",
    "nav.sources": "Источники",
    "nav.topics": "Топики",
    "nav.scripts": "Скрипты",
    "nav.settings": "Настройки",
    "nav.assistant": "Ассистент",
    "nav.info": "Информация",
    "nav.stockSearch": "Поиск футажей",

    // Stock Search
    "stock.title": "ПОИСК ФУТАЖЕЙ",
    "stock.subtitle": "Поиск бесплатных видео, фото и аудио из Pexels, Pixabay, Unsplash, Freesound",
    "stock.videos": "Видео",
    "stock.photos": "Фото",
    "stock.audio": "Аудио",
    "stock.search": "Искать",
    "stock.searchPlaceholder": "Введите запрос (авто-перевод на английский)",
    "stock.translatedTo": "Переведено на",
    "stock.noResults": "Ничего не найдено",
    "stock.tryDifferent": "Попробуйте другой запрос",
    "stock.configureApi": "Настройте API-ключи в настройках для большего количества результатов",
    "stock.portrait": "Вертикальные",
    "stock.landscape": "Горизонтальные",
    "stock.loadMore": "Загрузить ещё",
    "stock.loading": "Загрузка...",
    "stock.download": "Скачать",
    
    // Dashboard
    "dashboard.title": "Панель управления",
    "dashboard.subtitle": "Панель для создания и генераций, отслеживания новостей и скриптов. Воспользуйтесь меню для остальных функций.",
    "dashboard.updateTopics": "Обновить топики",
    "dashboard.fetchingTopics": "Загрузка топиков",
    "dashboard.fetchingDescription": "Начата загрузка топиков из всех источников",
    "dashboard.totalTopics": "Всего топиков",
    "dashboard.scriptsInWork": "Скриптов в работе",
    "dashboard.scriptsInWorkShort": "В работе",
    "dashboard.readyScripts": "Готовых скриптов",
    "dashboard.readyScriptsShort": "Готовых",
    "dashboard.createFromText": "РОЛИК ПО ТЕКСТУ",
    "dashboard.createFromTextShort": "ПО ТЕКСТУ",
    "dashboard.createFromMaterial": "РОЛИК ПО МАТЕРИАЛУ",
    "dashboard.createFromMaterialShort": "ПО МАТЕРИАЛУ",
    "dashboard.createFromTextDesc": "Генерация сценария и раскадровки по вашей идее или ссылке на новость, и создание полного пакета подготовки ролика",
    "dashboard.createFromMaterialDesc": "Загрузите свои съёмки",
    "dashboard.tip": "Для создания потока Шортсов и вертикального контента: добавьте источники и генерируйте короткие видео из них!",
    "dashboard.activeJobs": "Активные задачи",
    "dashboard.recentTopics": "Топики: поиск материала",
    "dashboard.recentTopicsShort": "Топики",
    "dashboard.recentScripts": "Последние скрипты",
    "dashboard.recentScriptsShort": "Скрипты",
    "dashboard.noActiveJobs": "Нет активных задач",
    "dashboard.allJobsCompleted": "Все фоновые задачи завершены",
    "dashboard.viewAll": "Смотреть все",
    
    // Text to Video
    "ttv.title": "РОЛИК ПО ТЕКСТУ",
    "ttv.inputLabel": "Исходный текст",
    "ttv.inputPlaceholder": "Введите текст, идею или черновик сценария. Чем больше деталей, тем лучше результат...",
    "ttv.characters": "символов",
    "ttv.minCharacters": "Минимум 50 символов",
    "ttv.settings": "Настройки генерации",
    "ttv.language": "Язык генерации",
    "ttv.style": "Стиль сценария",
    "ttv.duration": "Длительность",
    "ttv.seconds": "сек",
    "ttv.minutes": "мин",
    "ttv.sec": "сек",
    "ttv.min": "мин",
    "ttv.generate": "Генерировать",
    "ttv.generating": "Генерация...",
    "ttv.generatingHint": "ИИ анализирует текст и создаёт контент...",
    "ttv.generationComplete": "Генерация завершена",
    "ttv.generationCompleteDesc": "Сценарий, раскадровка и SEO данные успешно созданы",
    "ttv.generationError": "Ошибка генерации",
    "ttv.textRequired": "Нужен текст",
    "ttv.textRequiredDesc": "Пожалуйста, введите текст или идею",
    "ttv.textTooShort": "Текст слишком короткий",
    "ttv.textTooShortDesc": "Пожалуйста, введите минимум 50 символов",
    "ttv.analysisNotes": "Заметки ИИ-анализа",
    "ttv.seoTitle": "SEO Заголовок",
    "ttv.hashtags": "Хештеги",
    "ttv.fullScript": "Полный сценарий",
    "ttv.voiceover": "Озвучка с таймкодами",
    "ttv.timecode": "Таймкод",
    "ttv.voiceText": "Текст",
    "ttv.storyboard": "Раскадровка",
    "ttv.time": "Время",
    "ttv.visual": "Кадр",
    "ttv.onScreenText": "На экране",
    "ttv.sfx": "SFX",
    "ttv.hint": "Введите любой текст: статью, идею, новость или черновик. ИИ проанализирует и создаст полный сценарий с SEO-заголовком, хештегами, таймкодами озвучки и раскадровкой.",
    "ttv.voiceoverSaved": "Озвучка сохранена",
    "ttv.voiceoverSavedDesc": "Изменения сохранены в скрипте",
    "ttv.voiceoverUpdated": "Озвучка обновлена",
    "ttv.storyboardSaved": "Раскадровка сохранена",
    "ttv.storyboardSavedDesc": "Изменения сохранены в скрипте",
    "ttv.storyboardUpdated": "Раскадровка обновлена",
    "ttv.savedToScripts": "Сохранено в последние скрипты",
    "ttv.viewScript": "Открыть скрипт",
    "ttv.apiKeyRequired": "Нужен API ключ",
    "ttv.apiKeyRequiredDesc": "Укажите ключ OpenRouter (бесплатный) в Настройках для генерации сценариев.",
    
    // Sources
    "sources.title": "ИСТОЧНИКИ",
    "sources.subtitle": "Управление источниками для генерации сценариев",
    "sources.addSource": "Добавить вручную",
    "sources.noSources": "Источников пока нет",
    "sources.addFirstSource": "Добавьте свой собственный источник для сбора данных, если в общем списке его не нашлось.",
    "sources.name": "Название",
    "sources.type": "Тип",
    "sources.url": "URL",
    "sources.enabled": "Включён",
    "sources.disabled": "Отключён",
    "sources.rss": "RSS лента",
    "sources.telegram": "Telegram",
    "sources.manual": "Вручную",
    "sources.urlSource": "URL",
    "sources.delete": "Удалить",
    "sources.save": "Сохранить",
    "sources.cancel": "Отмена",
    "sources.editSource": "Редактировать источник",
    "sources.addNewSource": "Добавить новый источник",
    "sources.dialogDesc": "Настройте новый источник контента для поиска топиков",
    "sources.namePlaceholder": "Мой источник",
    "sources.telegramHint": "Используйте формат RSSHub для Telegram каналов",
    "sources.description": "Описание",
    "sources.descriptionPlaceholder": "Опишите какие темы охватывает этот источник...",
    "sources.created": "Источник создан",
    "sources.createdDesc": "Новый источник добавлен",
    "sources.createError": "Не удалось создать источник",
    "sources.updated": "Источник обновлён",
    "sources.updatedDesc": "Источник был обновлён",
    "sources.updateError": "Не удалось обновить источник",
    "sources.deleted": "Источник удалён",
    "sources.deletedDesc": "Источник был удалён",
    "sources.deleteError": "Не удалось удалить источник",
    
    // Topics
    "topics.title": "Топики",
    "topics.subtitle": "Находите и выбирайте трендовые темы для создания контента",
    "topics.refresh": "Обновить топики",
    "topics.noTopics": "Топиков пока нет",
    "topics.clickRefresh": "Нажмите 'Обновить топики' для загрузки контента из источников",
    "topics.all": "Все",
    "topics.new": "Новые",
    "topics.inProgress": "В работе",
    "topics.missed": "Упущенные",
    "topics.sortByScore": "По рейтингу",
    "topics.sortByDate": "По дате",
    "topics.select": "Выбрать",
    "topics.ignore": "Пропустить",
    "topics.score": "Рейтинг",
    "topics.source": "Источник",
    "topics.fetchError": "Не удалось начать загрузку",
    "topics.scriptCreated": "Скрипт создан",
    "topics.scriptCreatedDesc": "Вы выбрали тему и создали скрипт, теперь можно приступить к генерации!",
    "topics.selectError": "Не удалось создать скрипт",
    "topics.noFilteredTopics": "Топиков не найдено",
    "topics.noFilteredDesc": "Нет топиков с этим статусом",
    "topics.topicMissed": "Топик упущен",
    "topics.topicMissedDesc": "Топик отмечен как упущенный",
    "topics.cleared": "Топики очищены",
    "topics.clearedDesc": "Все топики удалены",
    "topics.clearConfirm": "Удалить все топики?",
    "topics.clearError": "Не удалось очистить топики",
    "dashboard.fetchError": "Не удалось начать загрузку топиков",
    
    // Scripts
    "scripts.title": "Скрипты",
    "scripts.subtitle": "Управление сгенерированными скриптами",
    "scripts.noScripts": "Скриптов пока нет",
    "scripts.selectTopic": "Выберите топик для создания первого скрипта",
    "scripts.goToTopics": "Перейти к топикам",
    "scripts.status.draft": "Черновик",
    "scripts.status.generating": "Генерация",
    "scripts.status.ready": "Готов",
    "scripts.status.approved": "Одобрен",
    "scripts.status.exported": "Экспортирован",
    "scripts.status.error": "Ошибка",
    "scripts.untitled": "Без названия",
    "scripts.updated": "Обновлён",
    "scripts.noFilteredScripts": "Скриптов не найдено",
    "scripts.noFilteredDesc": "Нет скриптов с этим статусом",
    
    // Script Detail
    "script.title": "Скрипт",
    "script.back": "Назад",
    "script.generateAll": "Сгенерировать всё",
    "script.export": "Экспорт",
    "script.overview": "Обзор",
    "script.content": "Контент",
    "script.storyboard": "Таймлайн",
    "script.audio": "Аудио",
    "script.topic": "Топик",
    "script.style": "Стиль",
    "script.duration": "Длительность",
    "script.format": "Формат",
    "script.formatShorts": "Shorts",
    "script.formatHorizontal": "Горизонтальное видео",
    "script.language": "Язык",
    "aiPrompt": "AI Промпт",
    "aiPromptCopied": "AI промпт скопирован в буфер обмена",
    "copyPrompt": "Копировать",
    "script.hook": "Хук",
    "script.voiceScript": "Текст для озвучки",
    "script.voiceScriptShort": "Текст",
    "script.clickToEdit": "Нажмите для добавления или редактирования...",
    "script.onScreenText": "Текст на экране",
    "script.generateHook": "Сгенерировать хук",
    "script.generateScript": "Сгенерировать скрипт",
    "script.generateStoryboard": "Сгенерировать раскадровку",
    "script.generateVoice": "Сгенерировать голос",
    "script.pickMusic": "Подобрать музыку",
    "script.scene": "Сцена",
    "script.visual": "Визуал",
    "script.text": "Текст",
    "script.sfx": "Звуки",
    "script.stockKeywords": "Ключевые слова для стоков",
    "script.music": "Музыка",
    "script.mood": "Настроение",
    "script.bpm": "BPM",
    "script.genre": "Жанр",
    "script.references": "Референсы",
    "script.license": "Лицензия",
    "script.freeTrackSuggestions": "Бесплатные треки",
    "script.edit": "Редактировать",
    "script.save": "Сохранить",
    "script.cancel": "Отмена",
    "script.seconds": "секунд",
    "script.notFound": "Скрипт не найден",
    "script.notFoundDesc": "Этот скрипт был удалён или не существует.",
    "script.backToScripts": "К скриптам",
    "script.productionPipeline": "Конвейер производства",
    "script.exportPackage": "Экспорт пакета",
    "script.downloadAssets": "Скачайте все материалы в ZIP для видеопроизводства",
    "script.exportZip": "Экспорт ZIP-пакета",
    "script.downloadLast": "Скачать последний экспорт",
    "script.recentJobs": "Последние задачи",
    
    // Settings
    "settings.title": "Настройки",
    "settings.subtitle": "Настройка API ключей и параметров по умолчанию",
    "settings.apiConfig": "Настройка API",
    "settings.apiConfigDesc": "Подключитесь к OpenRouter для генерации контента с помощью ИИ",
    "settings.apiKey": "API ключ OpenRouter",
    "settings.model": "Модель по умолчанию",
    "settings.testConnection": "Проверить соединение",
    "settings.testing": "Проверка...",
    "settings.connected": "Подключено",
    "settings.failed": "Ошибка",
    "settings.defaults": "Настройки по умолчанию",
    "settings.defaultsDesc": "Установите значения по умолчанию для новых скриптов",
    "settings.defaultDuration": "Длительность по умолчанию",
    "settings.defaultStyle": "Стиль по умолчанию",
    "settings.fallbackMode": "Режим без API",
    "settings.fallbackModeDesc": "Использовать шаблоны когда API недоступен",
    "settings.save": "Сохранить настройки",
    "settings.saved": "Настройки сохранены",
    "settings.savedDesc": "Ваши предпочтения обновлены",
    "settings.saveError": "Не удалось сохранить настройки",
    "settings.language": "Язык интерфейса",
    "settings.languageDesc": "Выберите предпочитаемый язык",
    "settings.theme": "Тема",
    "settings.getApiKey": "Получите API ключ на",
    "settings.connectedDesc": "API работает корректно",
    "settings.failedDesc": "Не удалось подключиться к API",
    "settings.fallbackWarningTitle": "Работа в режиме без API",
    "settings.fallbackWarningDesc": "Контент будет генерироваться с помощью шаблонов. Добавьте API ключ для лучших результатов.",
    "settings.providerSelection": "Провайдер ИИ",
    "settings.providerSelectionDesc": "Выберите провайдера ИИ. Groq и Together AI предлагают бесплатный тариф.",
    "settings.freeTier": "Бесплатно",
    "settings.aiActiveTitle": "ИИ генерация активна",
    "settings.aiActiveDesc": "Ваши сценарии будут генерироваться с помощью ИИ для более качественного контента.",
    
    // Common
    "common.loading": "Загрузка...",
    "common.error": "Ошибка",
    "common.success": "Успешно",
    "common.delete": "Удалить",
    "common.save": "Сохранить",
    "common.cancel": "Отмена",
    "common.close": "Закрыть",
    "common.add": "Добавить",
    "common.edit": "Редактировать",
    "common.view": "Просмотр",
    "common.russian": "Русский",
    "common.english": "Английский",
    "common.open": "Открыть",
    "common.generate": "Сгенерировать",
    "common.showMore": "Показать полностью",
    "common.showLess": "Свернуть",
    
    // Style presets
    "style.cinematic": "Кинематографичный",
    "style.director": "Режиссёрский",
    "style.meme": "Мемный",
    "style.trend": "Трендовый",
    "style.classic": "Классический",
    "style.news": "Новостной",
    
    // TTS
    "tts.title": "Предпрослушивание голоса",
    "tts.description": "Прослушайте скрипт с помощью синтеза речи браузера",
    "tts.voice": "Голос",
    "tts.selectVoice": "Выберите голос",
    "tts.speed": "Скорость",
    "tts.pitch": "Тон",
    "tts.preview": "Прослушать",
    "tts.stop": "Стоп",
    "tts.copyText": "Копировать текст",
    "tts.copied": "Скопировано",
    "tts.copiedDesc": "Текст скопирован для использования с внешними TTS сервисами",
    "tts.copyError": "Не удалось скопировать текст",
    "tts.playing": "Воспроизведение...",
    "tts.noText": "Нет текста",
    "tts.noTextDesc": "Добавьте текст для озвучки перед прослушиванием",
    "tts.playbackError": "Ошибка воспроизведения",
    "tts.notSupported": "Синтез речи не поддерживается в этом браузере",
    "tts.hint": "Предпрослушивание использует TTS браузера. Для продакшн-аудио скопируйте текст и используйте профессиональные сервисы: ElevenLabs, Amazon Polly или Google Cloud TTS.",

    // Job kinds
    "job.fetch_topics": "Загрузка топиков",
    "job.generate_hook": "Генерация хука",
    "job.generate_script": "Генерация скрипта",
    "job.generate_storyboard": "Генерация раскадровки",
    "job.generate_voice": "Генерация голоса",
    "job.pick_music": "Подбор музыки",
    "job.export_package": "Экспорт пакета",
    "job.generate_all": "Генерация всего",
    
    // Script detail page (additional)
    "script.settings": "Настройки",
    "script.scriptStyle": "Стиль скрипта",
    "script.voiceStyle": "Стиль голоса",
    "script.generateAllButton": "Сгенерировать всё",
    "script.generateAllShort": "AI",
    "script.pickMusicButton": "Подобрать музыку",
    "script.noStoryboard": "Раскадровки пока нет. Нажмите Сгенерировать для создания.",
    "script.noMusic": "Музыки пока нет. Нажмите Подобрать для рекомендаций.",
    "script.noHook": "Нажмите чтобы добавить или сгенерировать хук...",
    "script.noVoice": "Нажмите чтобы добавить или сгенерировать текст озвучки...",
    "script.exportDesc": "Скачайте все материалы в ZIP для видеопроизводства",
    "script.exportZipButton": "Экспорт ZIP-пакета",
    "script.tableVisual": "Визуал",
    "script.tableCamera": "Камера",
    "script.tableStockKeywords": "Ключевые слова",
    "script.tableStocks": "Стоки",
    "script.tableOnScreenText": "Текст на экране",
    "script.tableSubtitles": "Субтитры",
    "script.tableDuration": "Длительность",
    "script.tableTimecode": "Тайм",
    "script.tablePreview": "Превью",
    "script.stockKeywordsHint": "Ключевые слова для стоков",
    "script.copyKeywords": "Копировать",
    "script.keywordsCopied": "Ключевые слова скопированы",
    "script.topicLabel": "Топик",
    "script.generationStarted": "Генерация запущена",
    "script.exportReady": "Экспорт готов",
    "script.exportReadyDesc": "Ваш пакет готов к скачиванию",
    "script.scriptUpdated": "Скрипт обновлён",
    "script.failedToUpdate": "Не удалось обновить скрипт",
    "script.failedToGenerate": "Не удалось запустить генерацию",
    "script.failedToExport": "Не удалось экспортировать пакет",
    "copied": "Скопировано",
    "open": "Открыть",
    "30seconds": "30 секунд",
    "45seconds": "45 секунд",
    "60seconds": "60 секунд",
    "120seconds": "2 минуты",
    
    // Accent
    "script.accent": "Акцент",
    "accent.classic": "Классический",
    "accent.news": "Официальный",
    "accent.military": "Военный",
    "accent.blogger": "Блогер",
    "accent.meme": "Мемный",
    "accent.dramatic": "Драматический",
    "accent.ironic": "Ироничный",
    "accent.streamer": "Стример",
    
    // Subtitle export
    "script.subtitles": "Субтитры",
    "script.downloadSrt": "Скачать SRT",
    "script.downloadVtt": "Скачать VTT",
    "script.noSubtitles": "Сначала сгенерируйте таймлайн для экспорта субтитров",

    // Voice Generator
    "voice.title": "Генератор голоса",
    "voice.description": "Выберите стиль голоса и скопируйте текст в профессиональный TTS сервис",
    "voice.styleTab": "Стиль",
    "voice.phrasesTab": "Фразы",
    "voice.servicesTab": "Сервисы",
    "voice.generateFirst": "Сначала сгенерируйте текст озвучки",
    "voice.selected": "Выбран",
    "voice.recommendedVoices": "Рекомендуемые голоса:",
    "voice.copyAll": "Копировать всё",
    "voice.fullText": "Весь текст",
    "voice.numbered": "С нумерацией",
    "voice.phraseCount": "{count} фраз / {chars} символов",
    "voice.serviceHint": "Нажмите на сервис - текст скопируется автоматически, затем вставьте его в открывшемся окне.",
    "voice.copiedForService": "Весь текст скопирован для вставки в TTS сервис",
    "voice.pasteInService": "Вставьте текст в открывшемся сервисе",
    "voice.numberedCopied": "Текст с нумерацией скопирован",
    "voice.tip": "Совет:",
    "voice.tipContent": "Для стиля \"{style}\" рекомендуем: {voices}",
    "voice.style.narrator": "Диктор",
    "voice.style.narrator.desc": "Профессиональный, чёткий голос для документалок и объяснений",
    "voice.style.energetic": "Энергичный",
    "voice.style.energetic.desc": "Энергичный голос для трендов и вирального контента",
    "voice.style.calm": "Спокойный",
    "voice.style.calm.desc": "Расслабленный голос для образовательного и лайфстайл контента",
    "voice.style.meme": "Мемный",
    "voice.style.meme.desc": "Игривый голос для мемов и комедийного контента",
    "voice.style.news": "Новостной",
    "voice.style.news.desc": "Серьёзный голос для новостей и фактического контента",
    "voice.service.elevenlabs": "Лучшее качество, 10К символов/мес бесплатно",
    "voice.service.ttsmp3": "Бесплатный, без лимитов, мгновенное скачивание",
    "voice.service.freetts": "Бесплатный онлайн TTS со скачиванием",
    "voice.service.murf": "Профессиональные голоса",
    "voice.service.speechify": "Натуральные голоса, хороший бесплатный план",
    "voice.downloadTab": "Скачать",
    "voice.downloadHint": "Используйте эти сервисы для генерации и скачивания аудио. Текст скопируется автоматически.",
    "voice.generateTab": "Создать",
    "voice.generateHint": "Создайте MP3 напрямую с бесплатными голосами Microsoft Edge (без API ключа)",
    "voice.selectEdgeVoice": "Выберите голос",
    "voice.generateMp3": "Создать MP3",
    "voice.generating": "Генерация...",
    "voice.downloadMp3": "Скачать MP3",
    "voice.generationError": "Не удалось создать аудио",
    "voice.loadingVoices": "Загрузка голосов...",
    "voice.noVoices": "Голоса недоступны",
    "voice.rate": "Скорость",
    "voice.pitch": "Тон",
    "voice.voiceQuality": "Бесплатные нейросетевые голоса высокого качества",
    
    // Categories
    "category.title": "Выберите из категорий:",
    "category.description": "Выберите категории из списка и нажмите на плюсик, или добавьте собственный источник вручную.",
    "category.sources": "источников",
    "category.addAll": "Добавить все источники",
    "category.adding": "Добавление...",
    "category.added": "Добавлено",
    "category.exists": "Добавлено",
    "category.sourcesAdded": "Источники добавлены",
    "category.sourcesAddedDesc": "Добавлено {count} источников из категории {category}",
    "category.alreadyExists": "Уже добавлено",
    "category.alreadyExistsDesc": "Все источники этой категории уже в вашем списке",
    "category.world_news": "Мировые новости",
    "category.gaming": "Игры",
    "category.memes": "Мемы",
    "category.trends": "Тренды",
    "category.fashion": "Мода",
    "category.music": "Музыка",
    "category.interesting": "Интересное",
    "category.facts_research": "Факты и исследования",
    "category.movies": "Кино",
    "category.series": "Сериалы",
    "category.russia_news": "Новости России",
    "category.medicine": "Медицина",
    "category.youtube_trends": "YouTube тренды",
    "category.pets": "Питомцы и животные",
    
    // Profile & Auth
    "profile.title": "Профиль",
    "profile.nickname": "Никнейм",
    "profile.nicknamePlaceholder": "Введите никнейм",
    "profile.noNickname": "Никнейм не установлен",
    "profile.subscription": "Подписка",
    "profile.activeUntil": "Активна до",
    "profile.daysLeft": "дн. осталось",
    "profile.expired": "Подписка истекла",
    "profile.resetSettings": "Сбросить настройки",
    "profile.logout": "Выйти",
    "profile.updated": "Профиль обновлён",
    "profile.updatedDesc": "Ваш профиль был обновлён",
    "profile.updateError": "Не удалось обновить профиль",
    "profile.sessionExpired": "Сессия истекла",
    "profile.pleaseLogin": "Пожалуйста, войдите снова",
    "profile.reset": "Настройки сброшены",
    "profile.resetDesc": "Настройки сброшены по умолчанию",
    "profile.resetError": "Не удалось сбросить настройки",
    "profile.numberCopied": "Номер скопирован",
    "auth.login": "Войти",
    "auth.welcomeBack": "С возвращением!",
    "auth.loginSuccess": "Вы успешно вошли в систему",
    "auth.invalidPassword": "Неверный пароль",
    "auth.passwordPlaceholder": "Введите пароль",
    "auth.contactAdmin": "Обратитесь к администратору для получения доступа",
  },
};

const I18nContext = createContext<I18nContextType | null>(null);

function detectBrowserLanguage(): Language {
  if (typeof window === "undefined") {
    return "en";
  }
  const browserLang = navigator.language || (navigator as any).userLanguage;
  if (browserLang && browserLang.startsWith("ru")) {
    return "ru";
  }
  return "en";
}

function getSavedLanguage(): Language | null {
  if (typeof window === "undefined") {
    return null;
  }
  try {
    const saved = localStorage.getItem("idengine-language");
    if (saved === "ru" || saved === "en") {
      return saved;
    }
  } catch {
    // localStorage might not be available
  }
  return null;
}

export function I18nProvider({ children }: { children: ReactNode }) {
  const [language, setLanguageState] = useState<Language>(() => {
    return getSavedLanguage() || detectBrowserLanguage();
  });

  const setLanguage = (lang: Language) => {
    setLanguageState(lang);
    if (typeof window !== "undefined") {
      try {
        localStorage.setItem("idengine-language", lang);
      } catch {
        // localStorage might not be available
      }
    }
  };

  const t = (key: string): string => {
    return translations[language][key] || translations.en[key] || key;
  };

  return (
    <I18nContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </I18nContext.Provider>
  );
}

export function useI18n() {
  const context = useContext(I18nContext);
  if (!context) {
    throw new Error("useI18n must be used within I18nProvider");
  }
  return context;
}

export { translations };
